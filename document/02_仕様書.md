# SNCライブラリ - グラフィックデザイン：仕様書

作成日: 2026-02-04

## 1. システム構成（予定）
- フレームワーク: Laravel 10.x
- 言語/実行: PHP 8.1以上（Apache + PHP-FPM等、Xserver標準想定）
- DB: MySQL 8.0以上
- パッケージ管理: Composer
- 画像保存: サーバーのファイルシステム（`storage/app/public/uploads/` 配下、シンボリックリンク経由で公開）
- 画像処理:
  - Intervention Image（Laravel用画像処理ライブラリ）
  - バックエンド: `Imagick` があれば優先利用、なければ `GD` を利用

## 2. データ仕様
### 2.1 画像
- ジャンル: 1つ（必須）
- タグ: 複数（0個以上）
- 登録日: 自動（必須）
- メモ: 任意
- ファイル:
  - original: オリジナルファイル（保持）
  - display: 長辺4096px上限の表示用画像
  - thumb: 長辺512px目安の一覧用サムネイル

### 2.2 ジャンル/タグ
- ジャンル、タグは「事前登録制」
- 画像登録/編集時は候補から選択

## 3. 一覧の絞り込み仕様
- ジャンル: 単一選択（未選択=全件）
- タグ: 複数選択（未選択=全件）
- タグ条件: OR（選択したいずれかのタグを含む）

## 4. 拡大表示（ライトボックス）仕様
- 画像クリックでモーダル表示
- 前後移動:
  - 左右キー/スワイプ/ボタンで前後へ
- ズーム:
  - ホイール/ピンチで拡大縮小
  - ダブルクリック/ダブルタップで切替（実装で調整）
- 表示画像:
  - 通常は `display` を表示
  - 必要に応じて `original` への切替も検討（将来拡張）

## 5. 管理ページ仕様
### 5.1 認証
- `/admin/*` は簡易パスワード必須
- パスワードはサーバー環境変数（`.env`）で設定し、ハッシュで保持
- セッションでログイン状態を保持

### 5.2 画像アップロード
- 1回につき1枚
- 入力項目:
  - ファイル（必須）
  - ジャンル（必須）
  - タグ（任意、複数）
  - メモ（任意）
- バリデーション:
  - MIME/拡張子
  - 画像としてデコード可能か
  - ファイルサイズ: 「無制限」要望だが、実際は PHP/Apache の上限に依存（上限到達時はエラー表示）

### 5.3 編集/削除
- 編集: ジャンル/タグ/メモ
- 削除: DBレコード + `original/display/thumb` の各ファイル + 中間テーブルを削除

### 5.4 ジャンル/タグ管理
- 追加/編集/削除
- 削除時の扱い:
  - ジャンル削除: 紐づく画像がある場合は削除不可（推奨）または「未分類」へ退避（実装で決定）
  - タグ削除: 紐づく関連付けのみ削除し、画像自体は残す

## 6. テーマ切替
- ライト/ダークを切替
- `localStorage` に保存して次回も保持
- CSS変数ベースで実装

